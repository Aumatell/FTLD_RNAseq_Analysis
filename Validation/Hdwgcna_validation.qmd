---
title: "Validation: Gene modules analysis"
---

### HDWGCNA CORRESPONDANCE

Baed on shared genes, we matched the modules obtained from sant pau's cell states with the obteined from the validation datasets.

```{r}
# Load necessary libraries
library(dplyr)
library(DT)
library(GeneOverlap)

# Function to get list of subfolders in a directory
list_subfolders <- function(dir_path) {
  list.dirs(dir_path, recursive = FALSE, full.names = FALSE)
}

# Function to read gene list from a file (one column named "X")
read_genes <- function(file_path) {
  df <- read.csv(file_path, stringsAsFactors = FALSE, col.names = "X")
  if (!"X" %in% colnames(df)) {
    stop(paste("File", file_path, "does not contain column named 'X'"))
  }
  unique(df$X)
}

# Main function to compare files
compare_modules <- function(dir1, dir2) {
  folders1 <- list_subfolders(dir1)
  folders2 <- list_subfolders(dir2)
  
  # Check if folder structure is the same
  common_folders <- intersect(folders1, folders2)
  if (length(common_folders) == 0) {
    stop("No common folders found between directories")
  }
  
  results <- data.frame(
    folder         = character(),
    file_dir1      = character(),
    file_dir2      = character(),
    n_coincidences = integer(),
    jaccard        = numeric(),
    p_overlap      = numeric(),
    stringsAsFactors = FALSE
  )
  
  for (folder in common_folders) {
    modules_dir1 <- file.path(dir1, folder, "MODULES")
    modules_dir2 <- file.path(dir2, folder, "MODULES")
    
    if (!dir.exists(modules_dir1) | !dir.exists(modules_dir2)) {
      warning(paste("MODULES folder missing in", folder))
      next
    }
    
    files1 <- list.files(modules_dir1, pattern = "\\.csv$", full.names = TRUE)
    files2 <- list.files(modules_dir2, pattern = "\\.csv$", full.names = TRUE)
    
    # Exclude cor_summary.csv and hubs.csv
    files1 <- files1[!basename(files1) %in% c("cor_summary.csv", "hubs.csv")]
    files2 <- files2[!basename(files2) %in% c("cor_summary.csv", "hubs.csv")]
    
    # Read all files' genes once to speed up
    genes_list1 <- lapply(files1, read_genes)
    names(genes_list1) <- basename(files1)
    genes_list2 <- lapply(files2, read_genes)
    names(genes_list2) <- basename(files2)
    
    # Gene universe for this folder
    universe_genes <- unique(c(unlist(genes_list1), unlist(genes_list2)))
    universe_size  <- length(universe_genes)
    
    # Compare each file from dir1 with each file from dir2
    for (f1 in names(genes_list1)) {
      for (f2 in names(genes_list2)) {
        genes1 <- genes_list1[[f1]]
        genes2 <- genes_list2[[f2]]
        
        # Intersection and Jaccard
        n_common   <- length(intersect(genes1, genes2))
        union_size <- length(union(genes1, genes2))
        jaccard    <- if (union_size == 0) NA_real_ else n_common / union_size
        
        # GeneOverlap hypergeometric p-value
        if (universe_size == 0 || (length(genes1) == 0 && length(genes2) == 0)) {
          p_ov <- NA_real_
        } else {
          go_obj <- newGeneOverlap(genes1, genes2, genome.size = universe_size)
          p_ov   <- testGeneOverlap(go_obj)@pval
        }
        
        results <- rbind(
          results,
          data.frame(
            folder         = folder,
            file_dir1      = f1,
            file_dir2      = f2,
            n_coincidences = n_common,
            jaccard        = jaccard,
            p_overlap      = p_ov,
            stringsAsFactors = FALSE
          )
        )
      }
    }
  }
  
  results
}

# Usage example:
dir1 <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/hdWGCNA/FTLD/c9/CS_0.25_npcs2"
dir2 <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/hdWGCNA/Rimod/CS"

output_table <- compare_modules(dir1, dir2)

output_filtered <- output_table %>%
  filter(
    basename(file_dir1) != "grey.csv",
    basename(file_dir2) != "grey.csv"
  ) %>%
  arrange(is.na(p_overlap), p_overlap, desc(n_coincidences))

# ---- Quarto-friendly interactive table (filtered only) ----

datatable(
  output_filtered,
  filter  = "top",
  options = list(pageLength = 25, autoWidth = TRUE),
  caption = "Module overlaps (non-grey modules) between FTLD-C9 and RiMod, ranked by GeneOverlap p-value"
)


#write.csv(output_table, "C9_modules_gene_overlap_comparison.csv", row.names = FALSE)
```

```{r}
# Load necessary libraries
library(dplyr)
library(DT)
library(GeneOverlap)

# Function to get list of subfolders in a directory
list_subfolders <- function(dir_path) {
  list.dirs(dir_path, recursive = FALSE, full.names = FALSE)
}

# Function to read gene list from a file (one column named "X")
read_genes <- function(file_path) {
  df <- read.csv(file_path, stringsAsFactors = FALSE, col.names = "X")
  if (!"X" %in% colnames(df)) {
    stop(paste("File", file_path, "does not contain column named 'X'"))
  }
  unique(df$X)
}

# Main function to compare files
compare_modules <- function(dir1, dir2) {
  folders1 <- list_subfolders(dir1)
  folders2 <- list_subfolders(dir2)
  
  # Check if folder structure is the same
  common_folders <- intersect(folders1, folders2)
  if (length(common_folders) == 0) {
    stop("No common folders found between directories")
  }
  
  results <- data.frame(
    folder         = character(),
    file_dir1      = character(),
    file_dir2      = character(),
    n_coincidences = integer(),
    jaccard        = numeric(),
    p_overlap      = numeric(),
    stringsAsFactors = FALSE
  )
  
  for (folder in common_folders) {
    modules_dir1 <- file.path(dir1, folder, "MODULES")
    modules_dir2 <- file.path(dir2, folder, "MODULES")
    
    if (!dir.exists(modules_dir1) | !dir.exists(modules_dir2)) {
      warning(paste("MODULES folder missing in", folder))
      next
    }
    
    files1 <- list.files(modules_dir1, pattern = "\\.csv$", full.names = TRUE)
    files2 <- list.files(modules_dir2, pattern = "\\.csv$", full.names = TRUE)
    
    # Exclude cor_summary.csv and hubs.csv
    files1 <- files1[!basename(files1) %in% c("cor_summary.csv", "hubs.csv")]
    files2 <- files2[!basename(files2) %in% c("cor_summary.csv", "hubs.csv")]
    
    # Read all files genes once to speed up
    genes_list1 <- lapply(files1, read_genes)
    names(genes_list1) <- basename(files1)
    genes_list2 <- lapply(files2, read_genes)
    names(genes_list2) <- basename(files2)
    
    # Define gene universe for this folder (all genes seen in either dataset)
    universe_size <- length(unique(c(unlist(genes_list1), unlist(genes_list2))))
    
    # Compare each file from dir1 with each file from dir2
    for (f1 in names(genes_list1)) {
      for (f2 in names(genes_list2)) {
        genes1 <- genes_list1[[f1]]
        genes2 <- genes_list2[[f2]]
        
        # Intersection size
        n_common <- length(intersect(genes1, genes2))
        
        # Jaccard similarity
        union_size <- length(union(genes1, genes2))
        jaccard <- if (union_size == 0) NA_real_ else n_common / union_size
        
        # GeneOverlap hypergeometric p-value
        if (universe_size == 0 || (length(genes1) == 0 && length(genes2) == 0)) {
          p_ov <- NA_real_
        } else {
          go_obj <- newGeneOverlap(genes1, genes2, genome.size = universe_size)
          p_ov <- testGeneOverlap(go_obj)@pval
        }
        
        results <- rbind(
          results,
          data.frame(
            folder         = folder,
            file_dir1      = f1,
            file_dir2      = f2,
            n_coincidences = n_common,
            jaccard        = jaccard,
            p_overlap      = p_ov,
            stringsAsFactors = FALSE
          )
        )
      }
    }
  }
  
  results
}

# --- Usage example ---

dir1 <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/hdWGCNA/FTLD/TDP/CS_bo_ambhubs/"
dir2 <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/hdWGCNA/NEW/CS_bo/"

output_table <- compare_modules(dir1, dir2)

# Filter out grey modules and sort by p-value (non-NA first, lowest p first)
output_filtered <- output_table %>%
  filter(
    basename(file_dir1) != "grey.csv",
    basename(file_dir2) != "grey.csv"
  ) %>%
  arrange(is.na(p_overlap), p_overlap, desc(n_coincidences))

# ---- Quarto-friendly interactive table (filtered only) ----

datatable(
  output_filtered,
  filter = "top",
  options = list(pageLength = 25, autoWidth = TRUE),
  caption = "Module overlaps between FTLD-TDP and NEW (non-grey modules), ranked by GeneOverlap p-value"
)

# write.csv(output_table, "TDP_modules_gene_overlap_comparison.csv", row.names = FALSE)
```

### HDWGCNA DIFFERENCES

based on the previous matches the differences found are in modules that consist of a high % of shared genes.\
\
Add code and regenerate updated directly

#### TDP

| folder       | FTLD_C9_module | Rimmod_module  | Both sig |   Direction  |
|:-------------|:---------------|:---------------|---------:|-------------:|
| Arterial     | darkolivegreen | yellow         |  yes     |     + / +    |
| Arterial     | red            | grey           |  yes     |     + / +    |
| Arterial     | orange         | blue           |  no      |     + / -    |
| Arterial     | lightgreen     | blue           |  no      |     + / -    |
| Arterial     | tan            | yellow         |  yes     |     + / +    |
| Arterial     | grey60         | pink           |  yes     |     - / -    |
| Arterial     | steelblue      | blue           |  no      |     + / -    |
| Arterial     | blue           | green          |  yes     |     + / +    |
| Arterial     | yellow         | turquoise      |  no      |     - / -    |
| Capillary    | lightgreen     | green          |  yes     |     - / -    |
| CLMP_PDGFRA  | darkgrey       | darkred        |  no      |     + / +    |
| CUX2_RASGRF2 | orange         | green          |  no      |     - / +    |
| CUX2_RASGRF2 | pink           | turquoise      |  no      |     - / +    |
| CUX2_RASGRF2 | cyan           | saddlebrown    |  no      |     + / -    |
| CDH4_SCGN    | darkmagenta    | -------------- | -------- | ------------ |
| CDH4_SCGN    | plum1          | -------------- | -------- | ------------ |
| GFAP-neg     | darkturquoise  | brown          |  no      |     + / -    |
| GFAP-neg     | green          | magenta        |  yes     |     - / -    |
| GFAP-neg     | purple         | turquoise      |  yes     |     + / +    |
| GFAP-pos     | grey           | -------------- | -------- |  ----------- |
| GFAP-pos     | red            | brown          |  yes     |     - / +    |
| GFAP-pos     | darkturquoise  | red            |  yes     |     + / +    |
| GFAP-pos     | lightyellow    | turquoise      |  yes     |     - / +    |
| GFAP-pos     | cyan           | grey60         |  yes     |     + / -    |
| GFAP-pos     | greenyellow    | cyan           |  yes     |     + / +    |
| GFAP-pos     | lightcyan      | red            |  yes     |     + / +    |
| GFAP-pos     | black          | green          |  yes     |     + / +    |
| GFAP-pos     | grey60         | grey60         |  yes     |     + / -    |
| Micro        | lightyellow    | turquoise      |  yes     |     + / +    |
| Micro        | green          | turquoise      |  yes     |     - / +    |
| Micro        | magenta        | turquoise      |  yes     |     + / +    |
| Micro        | brown          | blue           |  yes     |     + / +    |
| Micro        | black          | turquoise      |  yes     |     - / +    |
| Micro        | pink           | turquoise      |  yes     |     + / +    |
| Micro        | skyblue3       | turquoise      |  yes     |     - / +    |
| Micro        | saddlebrown    | blue           |  no      |     + / -    |
| Micro        | salmon         | turquoise      |  yes     |     + / +    |
| Micro        | steelblue      | turquoise      |  yes     |     + / +    |
| Micro        | cyan           | turquoise      |  yes     |     + / +    |
| Micro        | orangered4     | turquoise      |  yes     |     + / +    |
| Micro        | yellow         | turquoise      |  yes     |     + / +    |
| Micro        | darkturquoise  | blue           |  no      |     + / -    |
| Micro        | darkgrey       | turquoise      |  yes     |     - / +    |
| Micro        | lightgreen     | blue           |  no      |     + / -    |
| Micro        | tan            | turquoise      |  yes     |     - / +    |
| Micro        | sienna3        | turquoise      |  yes     |     + / +    |
| Micro        | greenyellow    | turquoise      |  yes     |     - / +    |
| Micro        | violet         | blue           |  no      |     + / -    |
| Micro        | red            | blue           |  no      |     + / -    |
| Micro        | darkred        | turquoise      |  yes     |     - / +    |
| OPC          | purple         | -------------- |  ------  |     -----    |
| RORB_POU3F2  | pink           | turquoise      |  no      |     - / -    |
| RORB_POU3F2  | red            | turquoise      |  no      |     + / -    |
| RORB_POU3F2  | turquoise      | brown          |  no      |     + / -    |
| RORB_POU3F2  | magenta        | turquoise      |  no      |     - / -    |
| SMC          | yellow         | yellow         |  yes     |     + / +    |
| SMC          | green          | green          |  yes     |     - / -    |
| SMC          | paleturquoise  | blue           |  no      |     - / -    |
| T_Cell       | turquoise      | turquoise      |  yes     |     + / +    |
| T_Cell       | yellow         | yellow         |  yes     |     + / +    |
| T_Cell       | white          | white          |  no      |     + / +    |
| T_Cell       | magenta        | magenta        |  no      |     - / -    |
| T_Cell       | darkred        | yellow         |  yes     |     - / -    |


#### C9

| folder       | FTLD_TDP_module | Pottier_module | both sig |    direction |
|:-------------|:----------------|:---------------|---------:|-------------:|
| Arterial     | greenyellow     |                |  yes     |     - / -    |
| Arterial     | lightgreen      |                |  yes     |     + / -    |
| Arterial     | red             |                |  yes     |     + / -    |
| Arterial     | yellow          |                |  yes     |     - / -    |
| Arterial     | darkgrey        |                |  yes     |     + / -    |
| Arterial     | green           |                |  yes     |     + / -    |
| Arterial     | magenta         |                |  yes     |     + / -    |
| Capillary    | pink            |                |  yes     |     + / -    |
| Capillary    | green           |                |  yes     |     - / -    |
| Capillary    | grey60          |                |  yes     |     - / -    |
| Capillary    | black           |                |  yes     |     - / -    |
| Capillary    | brown           |                |  yes     |     + / -    |
| Capillary    | red             |                |  yes     |     - / -    |
| CDH4_SCGN    | darkgreen       | -------------- | -------- | ------------ |
| CDH4_SCGN    | magenta         | -------------- | -------- | ------------ |
| CDH4_SCGN    | darkgrey        | -------------- | -------- | ------------ |
| CDH4_SCGN    | skyblue         | -------------- | -------- | ------------ |
| CDH4_SCGN    | greenyellow     | -------------- | -------- | ------------ |
| CDH4_SCGN    | grey60          | -------------- | -------- | ------------ |
| CUX2_RASGRF2 | pink            |                |  no      |     - / +    |
| CUX2_RASGRF2 | black           |                |  no      |     + / +    |
| CUX2_RASGRF2 | royalblue       |                |  no      |     - / -    |
| CUX2_RASGRF2 | yellow          |                |  no      |     + / +    |
| CUX2_RASGRF2 | red             |                |  no      |     + / +    |
| CUX2_RASGRF2 | brown           |                |  no      |     - / -    |
| GFAP-neg     | black           |                |  yes     |     - / -    |
| GFAP-neg     | red             |                |  yes     |     + / -    |
| GFAP-neg     | midnightblue    |                |  yes     |     + / -    |
| GFAP-neg     | yellow          |                |  yes     |     - / -    |
| GFAP-neg     | tan             |                |  yes     |     - / -    |
| GFAP-neg     | salmon          |                |  yes     |     + / -    |
| GFAP-neg     | green           |                |  yes     |     - / -    |
| LAMP5_PMEPA1 | red             |                |  yes     |     - / -    |
| LAMP5_PMEPA1 | midnightblue    |                |  yes     |     - / -    |
| LAMP5_PMEPA1 | pink            |                |  yes     |     + / -    |
| LAMP5_PMEPA1 | blue            |                |  yes     |     - / -    |
| LAMP5_PMEPA1 | yellow          |                |  yes     |     + / -    |
| LAMP5_PMEPA1 | lightgreen      |                |  yes     |     + / -    |
| LAMP5_PMEPA1 | green           |                |  yes     |     + / -    |
| Micro        | red             |                |  yes     |     - / -    |
| Micro        | greenyellow     |                |  yes     |     + / -    |
| Micro        | pink            |                |  yes     |     + / -    |
| Micro        | purple          |                |  yes     |     + / -    |
| Micro        | brown           |                |  yes     |     - / -    |
| Micro        | green           |                |  yes     |     - / -    |
| Oligo        | green           |                |  yes     |     - / -    |
| Oligo        | black           |                |  yes     |     + / -    |
| Oligo        | grey60          |                |  yes     |     + / -    |
| Oligo        | purple          |                |  yes     |     - / -    |
| Oligo        | brown           |                |  yes     |     + / -    |
| Oligo        | royalblue       |                |  yes     |     - / -    |
| RORB_ADGRL4  | mediumpurple3   |                |  yes     |     + / -    |
| RORB_ADGRL4  | lightyellow     |                |  yes     |     - / -    |
| RORB_ADGRL4  | salmon          |                |  yes     |     - / -    |
| RORB_ADGRL4  | darkolivegreen  |                |  yes     |     + / -    |
| RORB_ADGRL4  | midnightblue    |                |  yes     |     - / -    |
| RORB_ADGRL4  | plum1           |                |  yes     |     + / -    |
| RORB_ADGRL4  | skyblue3        |                |  yes     |     + / -    |
| RORB_ADGRL4  | magenta         |                |  yes     |     + / -    |
| RORB_ADGRL4  | orangered4      |                |  yes     |     + / -    |
| RORB_ADGRL4  | violet          |                |  yes     |     + / -    |
| RORB_ADGRL4  | lightgreen      |                |  yes     |     + / -    |
| RORB_ADGRL4  | steelblue       |                |  yes     |     + / -    |
| RORB_ADGRL4  | orange          |                |  yes     |     + / -    |
| RORB_FOXO1   | darkorange      |                |  yes     |     - / -    |
| RORB_LRRK1   | black           |                |  yes     |     - / -    |
| RORB_LRRK1   | brown           |                |  yes     |     + / -    |
| RORB_LRRK1   | green           |                |  yes     |     - / -    |
| RORB_LRRK1   | red             |                |  yes     |     - / -    |
| RORB_LRRK1   | grey60          |                |  yes     |     - / -    |
| RORB_LRRK1   | magenta         |                |  yes     |     + / -    |
| RORB_POU3F2  | yellow          |                |  yes     |     - / -    |
| RORB_POU3F2  | green           |                |  yes     |     + / -    |
| RORB_POU3F2  | pink            |                |  yes     |     + / -    |
| RORB_POU3F2  | purple          |                |  yes     |     + / -    |
| RORB_POU3F2  | red             |                |  yes     |     + / -    |
| RORB_POU3F2  | brown           |                |  yes     |     - / -    |
| SMC          | royalblue       |                |  yes     |     - / -    |
| SMC          | magenta         |                |  yes     |     + / -    |
| SMC          | green           |                |  yes     |     + / -    |
| SMC          | yellow          |                |  yes     |     - / -    |
| SMC          | lightcyan       |                |  yes     |     - / -    |
| SMC          | red             |                |  yes     |     - / -    |
| SMC          | pink            |                |  yes     |     + / -    |
| SMC          | greenyellow     |                |  yes     |     - / -    |
| SST_BRINP3   | greenyellow     |                |  yes     |     + / -    |
| SST_NPY      | royalblue       |                |  yes     |     + / -    |
| T_Cell       | lightgreen      |                |  yes     |     + / -    |
| T_Cell       | red             |                |  yes     |     - / -    |
| T_Cell       | magenta         |                |  yes     |     + / -    |
| T_Cell       | salmon          |                |  yes     |     + / -    |
| T_Cell       | white           |                |  yes     |     + / -    |
| T_Cell       | grey60          |                |  yes     |     - / -    |
| T_Cell       | lightyellow     |                |  yes     |     + / -    |
| T_Cell       | darkorange      |                |  yes     |     + / -    |
| T_Cell       | green           |                |  yes     |     - / -    |
| T_Cell       | brown           |                |  yes     |     + / -    |
| T_Cell       | midnightblue    |                |  yes     |     - / -    |
| T_Cell       | black           |                |  yes     |     + / -    |
| T_Cell       | royalblue       |                |  yes     |     - / -    |
| T_Cell       | darkgrey        |                |  yes     |     - / -    |
| THEMIS_NR4A2 | darkgrey        |                |  yes     |     - / -    |
| THEMIS_NR4A2 | orange          |                |  yes     |     + / -    |
| TLE4_MEGF11  | cyan            |                |  yes     |     + / -    |
| TLE4_MEGF11  | midnightblue    |                |  yes     |     + / -    |
| VIP_CLSTN2   | salmon4         |                |  yes     |     - / -    |

## LISTS (Will be removed )

#### FTLD-C9

Arterial:

greenyellow - organic hydroxy compound transport, ceramide biosynthetic process, peptide receptor activity, neuropeptide signaling pathway, ligand-gated monoatomic cation channel activity, negative regulation of gliogenesis, synaptic transmission glutamatergic

lightgreen + positive regultaion of stablishment of protein localization telomere, DNA integration , DNA-templated transcription, mismatch repair, catalytic activity acting on DNA, ferrous iron binding, ergulation of endocrine process

red + promoter specific chromatin binding, heterochromatin , chromosome organization

yellow - mechanosensitive monoatomic channel activity, mucocilary cleareanvce, regulation of synaptic vessicle fussion to presinaptic active zone membrane

darkgrey + carbohydrate binding, phosphatidylcholine binding, Schaffer colateral CA1 synapse, chemocal synaptic transmission , response to osmotic stress

green + ribosomal subunit biogenesis, ribonucleoprotein complex biogenesis, tRNA metabolic process, cullin-RING ubiquitin ligase complex, SMN complex, nRNA splicing via spliceosome

magenta + reionalzation, retection of chamical stimulus involved in sensory perception, appendage development, cell fate specification

Capillary:

pink +

green -

grey60 -

black -

brown +

red -

CDH4 SCGN:

darkgreen +

magenta -

darkgrey +

skyblue -

greenyellow -

grey60 -

CUX2 RASGRF:

pink -

black +

royalblue -

yellow +

red +

brown -

GFAP - :

black -

red +

midnightblue +

yellow -

tan -

salmon +

green -

LAMP5_PMEPA1:

red -

midnightblue -

pink +

blue -

yellow +

lightgreen +

green +

Micro:

red -

greenyellow +

pink +

purple +

brown -

green -

Oligo:

green - black + grey60 + purple - brown + royalblue -

RORB_ADGRL4:

mediumpurple3 + lightyellow - salmon - darkolivegreen + midnightblue - plum1 + skyblue3 + magenta + orangered4 + violet + lightgreen + steelblue + orange +

RORB_FOXO1:

darkorange - calcuim ion binding, camera-eye type development, dandrite

RORB_LRRK1:

black - brown + green - red - grey60 - magenta +

RORB_POU3F2:

yellow - green + pink + purple + red + brown -

SMC:

royalblue - magenta + green + yellow - lightcyan - red - pink + greenyellow -

SST\_ BRINP3:

greenyellow + Unconventional myosin complex , liver development , non-motile cilium , multicellular organism-level iron homeostasis, response to copper iron, hippocampal mossy fiber to CA3 sinapse, regulation of leukocyte apoptotic process

SST_NPY:

royalblue + postsynaptic dendrite membrane, axon extension involved in acon guidance, postsynaptic specialiaztion asembly, regulation of PH, adult behaviour,

T Cell:

lightgreen + red - magenta + salmon + white + grey60 - lightyellow + peptide receptor activity, chemical synaptic transmission, membrane lipod metabolic process, feeding behavious, collagen binding darkorange + green - brown + midnightblue - black + royalblue - darkgrey -

THEMIS_NR4A2:

darkgrey - elarning or memory, beta-tubulin binding, positive regulation of protein localization, positive egulation of synaptic vessicle fussing to presinaptic active zone membrane, postsynaptic density, orange + presynapse , neuronal cell body , postsynapse, positive regulation of neuro projection development, vacuole organization , golgi membrane, regulation of mRNA stability

TLE4_MEGF11:

cyan + regulation of skeletal muscle tissue development, olfacotry bulb development, regulation of mitochondrial gene expression , striated muccle cell filament, midnightblue + Sm-like protein family complex, negative regulation of osteoblast differenciation, O-methyltransferase activity, peptide metabolic process, neurotransmitter receptor activity

VIP_CLSTN2:

salmon4 - cortical cytosckeleton organization, coated vessicle membrane, andosomal transport, external encapsulating structure, regulation of cell sunction assembly

#### Rimmod

Arterial:

tan + brown + green - grey + turquoise - blue +

Capillary:

greenyellow + cyan +\
lightyellow + brown + green - red - blue - grey + turquoise + darkgreen - black +

CDH4_SCHN:

turquoise + white + grey60 + darkgreen + orange + blue + cyan + magenta - skyblue - darkred + tan + violet + purple + darkturquoise + red - lightcyan - greenyellow + darkorange - paleturquoise - lightyellow - darkgrey - darkolivegreen - lightgreen -

CLMP_KCNMA1:

grey + darkorange2 + steelblue + grey60 + turquoise + navajowhite2 + darkturquoise + white + green + yellow + plum1 + lightsteelblue1 + royalblue + purple + black + tan + maroon + lightyellow + pink + brown + yellowgreen + paleturquoise + palevioletred3 + darkgrey - thistle2 + salmon4 + saddlebrown + sienna3 + skyblue3 + thistle1 + darkred + darkolivegreen + ivory + salmon + mediumpurple3 +

CLMP_PDGFRA:

turquoise + grey + blue + red + yellow + black + brown +

CUX2 RASGRF2:

purple + blue + red - lightcyan + grey + black - turquoise -

DISC1_CCK:

white - cyan - darkgreen -

GFAP - :

greenyellow + blue + red - cyan + grey + turquoise - black -

GFAP + :

magenta + purple + grey + turquoise + black -

LAMP5_PMEPA1:

greenyellow + green + lightyellow + yellow - lightgreen + grey + grey60 + blue - turquoise + magenta -

Micro:

magenta + yellow + black - pink - grey + lightcyan + brown + turquoise -

Oligo:

cyan + tan + midnightblue + red + brown - grey + greenyellow - turquoise + blue - black +

PVALB_MYBPC1:

brown -

RORB_ADGRL4:

yellow + greenyellow + lightgreen + darkolivegreen + turquoise + darkmagenta + brown - pink - black + darkgreen - lightcyan + saddlebrown +

RORB_FOXO1:

black + cyan + palevioletred3 + yellowgreen + lightyellow + orange + darkolivegreen + purple + thistle1 + midnightblue + pink + lavenderblush3 + bisque4 - salmon4 + skyblue + mediumpurple3 - saddlebrown + lightcyan + paleturquoise + lightsteelblue1 + darkslateblue - darkgrey + blue - plum2 + skyblue3 + darkorange2 + turquoise + darkmagenta + honeydew1 -

RORB_LRRK1:

purple + blue + darkturquoise + yellow - salmon + greenyellow + pink - royalblue + darkred + turquoise + orange - grey + green - magenta +

SCN4B_NEFH:

grey - salmon + red - brown -

SMC:

greenyellow + brown + green - grey + purple - blue +

SST_GALNT14:

lightyellow +

T Cell:

greenyellow + brown + tan + yellow - midnightblue + green + grey + turquoise -

TLE4_CCBE1:

magenta + saddlebrown + black +

TLE4_SEMA3D:

lightcyan + purple + steelblue + paleturquoise + grey + darkred + cyan + midnightblue + greenyellow + darkgrey + salmon + darkmagenta + darkgreen + saddlebrown + red + lightyellow + darkorange + brown + brown4 + grey60 + yellow + green + white + black + turquoise + navajowhite2 + tan + lightgreen + darkturquoise + blue + floralwhite - royalblue + skyblue + yellowgreen + thistle1 + pink + plum2 + plum1 +

VAT1L EYA4:

lightsteelblue1 - blue - thistle2 -

VIP_CLSTN2:

midnightblue + thistle2 + palevioletred3 + skyblue + yellowgreen + darkolivegreen + darkgreen + ivory + lightcoral + lightcyan + lavenderblush3 - honeydew1 + black + violet + salmon + brown + cyan + purple + maroon + skyblue3 + darkorange2 + grey + greenyellow + darkorange + darkgrey - grey60 + mediumpurple3 + tan + indianred4 + darkolivegreen4 + steelblue + darkseagreen4 + mediumorchid + floralwhite + orangered4 + darkmagenta + saddlebrown + skyblue2 + navajowhite2 + coral2 + sienna3 + yellow4 + mediumpurple2 +

VIP_HTR2C:

lightgreen -

#### FTLD-TDP

Arterial:

darkolivegreen + meiotic cell cycle, digestive system development, male gamete generation , adenylate cyclase-activating G protein-coupled receptor signaling pathway, RNA nuclease activity red + fatty acid metabolic process, neurotreanmitter receptor activity, vacuolar acidification, positive regulation of intercellular estrogen receptor signaling pathway, androgen metabolic process, cellular defense response orange + detection of chmical stimulus involved in sensory perception , cytokine activitym cellular response to copper and iron, hormone metabolic process, cellullar defense response lightgreen + olfactory receptor activity, nuclear division, regulation of mitotic nuclear division , sterioid hydroxylase activity, cell fate specification tan + complement activation classical pathway, regulation of T cell extravasation, error-prone translesions synthesis, response to pain, regulation of B cell mediated immunity, mRNA modification. grey60 - proteoglycan metabolic process, hormone biosinthetic processm glomerular basement membrane development, neuromuscular suiaptic transmission. steelblue + detection of chemical stimulus involved in sensory perception , late endosome lumen, sensory perception of taste, axoneme, positive regulation of T cell proliferation , leucocyte mediated cytotoxicity blue + humoral immune response, cytokine activation , detection of chemical stimulus involved in sensory perception, hormone activiy, inflamatory response, response to bacterium , adaptative immune response yellow - presynapse, active monoatomic ion transmembrane transporter activity, synaptic signaling, regulation of postsynapse assembly

Capillary:

lightgreen - neuropeptide binding, spinal cord development, hyaluronic acid binding, regulation of smooth muscle cell migration, regulation of BPM signaling pathway

CDH4_SCGN:

darkmagenta + positive regulation of protein-coding complex assembly, endoplasmatic reticulum lumen, sodium channel activity plum1 + intrinsic apoptitic signaing pathway, regulation of alternative mRNA splicing via spliceosome

CLMP_PDGFRA:

darkgrey + protein tyrosine phosphate activity, protein serine/theroine kinnase binding, mithocondrial protein-contaiing complex

CUX2_RASGRF2:

orange - detection of chemical stimulus involved in sensory eprception, hormone activity, extracellular matric etructural constituent, retinoid binding, feeding behaviour pink - regulation of muscle system process, cellullar response to peptide hormone stimulus, regulation of blood preassure, regulation of supramoleular fiber organization, regulation of postsynapse assembly, positive regulation of cell migration cyan + 5'-3' exonuclease activity, lipid droplet formation , cell division , response to progesterone, negative regulation of gliogenesis, translation repression activity, transcription reglator inhibitor activity.

GFAP - :

darkturquoise + olfactory receptor activity, neuropeptide signaling pathway, retinol metabolic process, deaminase activity, defense response to bacterium , immune receptor activity green - hormone activity, axternal encapsulating structure, G-protein-coupled peptide receptor activity, angiogenesis, detection of chemical stimulus involved in sensory perception , purple + immunoglobulin binding, endoplasmic reticulum-Golgi intermediate compartment membrane, positive regulation of imune response, androgen metabolic process, signal recognition particle binding, response to ATp,

GFAP +:

grey - olfactory receptor activity, receptor ligand activity, killing of cells of another organism, external encapsulating structure, hummoral immune response, structural constituent of skin epidermis, hormone activiry, defense response o bacterium, inflamatory response, leukocyte migration involved in infammatory response red - CCR4-MOT core complex, cmall molecule catabolic process, regulation of potassium ion transmembrane transporter activity, quinone metabolic process, positive regulation by host of viral genome replication, darkturquoise + detection of chemical stimulus involved in sensory perception, icosanoid secretion , hormone metabolic process, regulation of blood pressure, response to bacterium, killing of cells of another organism lightyellow - GTPase regulator activity, mitochondrion-endoplasmatic reticulum membrane tethering, axon , microglia differenciation , regulation of postsynapse assembly, positive regulation of apoptotic process cyan + detection of chemical stimulus involved in sensory perception, signaling receptor regulator activity, serine-type endopeptidase activity, DNA-binding transcription activator activity RNApolymerase II specific, natural killer cell activation, monooxigenase activity, regulation of type II interferon production greenyellow + olgfactory receptor activity, negative regulation of transmission of nerve impulse, xenobiotic metabolic process, negative regulation of homeostasis, endopeptidase inhibitor activity, killing of cells of another organism lightcyan + olfactory receptor activity, sister chromatid segregation , cell fate specification , cornified envelope, hormone activity, cell maturation black + signaling receptor regulator activitym rsponse to bacterium , immune receptor activity, external side of plasma membrane , adaptative immune response, regulation of effector immune process, leukocyte activation , mononuclear cell migration , cegulatio nof inflammatory response grey60 + olfactory receptor activity, positive regulation of immune efector process, humoral immune response, peptidase inhibitor activity

Micro:

lightyellow + catalytic activity acting on RNA, mRNAmodification , subpallium development, miotic sister chromatid cohesion green - synaptic signaling, cell body, regulation of synaptic plasticity, negative regulation of cation transmembrane transport, spinal cord development, meuropeptide signaling pathway, dendritic shaft, tau protein binding magenta + estradiol 17-beta-dehidrogenase NADP+ activity postsynaptic neurotransmitter receptor activity, nuclear exosome RNAse complex brown + signaling receptor regulation activity, killing of cells of another organism, heparin binding, external encapsulating structure, cell-cell adhesion , cormone activity

OPC:

purple + amide metabolic process, insulin processing, methyl-cpg binding, positive regulation of cation channel activity

RORB_POU3F2:

pink - angiogenesis, negative rgulation of fibroblast growth factor receptor signaling pathway, polysaccharide biosynthetic process, structural costituent of postsynaptic actin sytosckeleton, external encapsulating structure red + fattyaccid oxidation using acyl-CoA oxidase, gluttamate-gated calcuim ion channel activity, cellular response to unfolded protein, vacuolar acidification, mRNA cis-splicing via spliceosome. turquoise + hummoral immune response, killing of cells of another ogranism, immune effector process , response to bacterium , inflammatory response, positive regulation of immune response, mononuclear cell migration, leukocyte mediated immunity, immune receptor activity, regulation of immune response, regulation of mononulear cell proliferation magenta - celular response to hormone stimulus, regualtion of calcium-mediated stimulus , regulation of anatomical structure size, postsynapse , axon , synaptic signaling

SMC:

yellow + fattyacid beta-oxidation using acyl-CoA oxidase, DNA replication preinitiation complex, mRNA cis splicing via spliceosome, cillium movement involved in cell motillity, postsinaptic neurotreansmitter receptor activity green - hydrolase activity acting on glicosyl bonds, fat-soluble vitamin metabolic process, peptide receptor activity, signaling receptor regulator activity, neuropeptide signaling pathway, paleturquoise - ( no enriched terms)

T Cell:

turquoise + external encapsulating structure, receptor ligand activity, cell-cell adhesion via plasma-membrane adhesion molecules , detection of stimulus involved in sensory perception , alpha-amino acid metabolic process, peptide receptor activity, hummoral immune response, endoplasmatic reticulum lument, yellow + hormone byosinthetic process , intramolecular transferase activity, neurotransmitter receptor activity, dolichol-linked oligosaccharide syoisinthetic process, white + chromosome segregation , porphyrin-containing compound biosynthetic process, visual perception , centromere complex assembly, RNA methylation, negative regulation of mitotic nuclear division magenta - regulation of muscle system process, response to pain, inositol1-4 5 triphosphate 5-phosphatase activity, regulation of polysynapse assembly, RNA polymerase III complex, associative learning, postsynaptic vessicle membrane darkred - external encapsulating structure, lymph vessel development, megative regulation of keratinocyte differenciation,

#### Pottier

Arterial:

tan + pink - green + yellow + salmon - cyan + red + brown -

Capillary:

greenyellow - salmon + green - pink + grey + turquoise +

CLMP_KCNMA1:

grey + lightcyan + green + magenta + yellow + midnightblue + red + purple + tan + black + brown + cyan +

CLMP_PDGFRA:

grey + royalblue +

DISC1_CKK:

plum2 - violet + lightyellow - darkgrey - magenta + tan - palevioletred3 -

GFAP - :

magenta - green + black + tan + yellow + cyan - purple + turquoise +

GFAP + :

turquoise + grey + purple + blue + pink + lightcyan + midnightblue + red + green + brown + magenta + tan + salmon + yellow + cyan + lightgreen + greenyellow + grey60 - black +

LAMP5_CA3:

mediumpurple3 - magenta - floralwhite - grey - darkorange - yellow -

LAMP5_PMEPA1:

violet - turquoise - grey - darkred - darkgreen + yellow - darkorange - darkgrey - tan - paleturquoise - black - steelblue -

Oligo:

magenta - black + blue + greenyellow + cyan + red + salmon - yellow - midnightblue + purple + tan + brown - pink + grey - turquoise -

Pericyte:

steelblue -

PVALB_CEMIP:

purple + skyblue - grey - blue - turquoise +

PVALB_MYBPC1:

white - plum2 + maroon - darkturquoise - grey - grey60 - saddlebrown - magenta - thistle1 - darkgreen +

SCN4B_NEFH:

ivory - mediumorchid - saddlebrown - blue - grey - lightcyan - black + mediumpurple3 - brown - pink - skyblue1 + maroon + darkturquoise - grey60 - violet - bisque4 + plum1 + plum2 - tan + turquoise - steelblue - lightyellow - coral1 -

SMC:

green - purple + yellow + black + brown + cyan + tan +

SST_ADAMTS19:

brown4 - orangered4 - darkolivegreen - bisque4 -

SST_BRINP3:

floralwhite -

SST_GALNT14:

lightyellow - darkolivegreen + floralwhite - plum1 + darkgrey + thistle2 +

T_Cell:

yellow - magenta + greenyellow + red + black + cyan + green - lightcyan + midnightblue + purple +

THEMIS_TMEM233:

purple + blue + yellow + lightcyan1 - brown + cyan -

TLE4_CCBE1:

bisque4 + lightsteelblue1 -

TLE4_MEGF11:

orangered4 - skyblue3 - tan - lightgreen + brown -

TLE4_SEMA3D:

orange - thistle2 +

```{r}

```

```{r}

```
