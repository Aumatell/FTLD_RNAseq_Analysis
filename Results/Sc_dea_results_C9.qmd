---
title: "Single cell difference expression analysis ( C9orf72 )"
---

## C9

From the 43 deconvolved cells, only 28 had sufficient expression levels for EdgeR to perform differential expression analysis. Among these, 15 distinct cell types showed significant differential gene expression. RORB/POU3F2 characterized excitatory neuron exhibited the highest anount of alterations, with 433 differentially expressed genes (DEGs) and RORB/LRRK1 (263 DEGs) was also notably affected. For the inhibitory neurons we found DEG in the cells characterized by CUX2/RASGRF2 123, LAMP5/PMEPA1 22. Smooth muscle cells (SMC) also shown 270 DEG. Vascular cells such as arterial, and capillary subtypes displayed 52 and 63 deregulated genes respectively. T cells contributed with 33 DEGs. Across all cell types, upregulated genes were more frequent than downregulated ones.

### Excitatory neurons

Differences in excitatory neuron composition reveal key changes in RORB-characterized subtypes. Differential gene expression analysis at cell state resolution identified downregulation of the disease-associated gene C9orf72 in the CUX2/RASGRF2 (adjusted p= 0,016 FC: 0.75), RORB/LRRK1(adjusted p= 0,026; FC: 0.78), and RORB/POU3F2 (adjusted p= 0,033; FC: 0,79) subtypes (PMCID: PMC3430713). Additionally, inflammatory marker genes were upregulated across excitatory neuron subtypes. For example, CHI3L1 was found upregulated in RORB/POU3F2(adjusted p=: 0,036; FC: 2,69) , consistent with its known elevation in cerebrospinal fluid as a biomarker (PMID: 32344399).

Hemoglobin subunits HBA1 in RORB/LRRK1 (adjusted p= 0,041; FC: 0,22) and RORB/POU3F2 (p= -0.04; FC: 0,22) and HBB in RORB/LRRK1 (adjusted p= 0,036; logFC: 0.23) and RORB/POU3F2 (adjusted p= 0,024; logFC: 0,23) also showed decreased expression that has been previously described in the frontal cortex of patents with neurodegenerative diseases (PMCID: PMC5786544). Functionally, downregulated genes in RORB/LRRK1 and RORB/POU3F2-expressing neurons are enriched in postsynaptic components and synaptic transmission. In the CUX2/RASGRF subtype, affected genes relate to postsynapse and transmission regulation. Upregulated genes in the CUX2/RASGRF subtype indicate enrichment in behavior, presinapse, and neuron apoptotic process, while in RORB/LRRK1 and RORB/POU3F2 subtypes, they relate to synaptic organization, behaviour and amyloid-beta response.

### Inhibitory neurons

Inhibitory neurons display vulnerable transcriptional signatures in LAMP5/PMEPA1. Alterations in LAMP5/PMEPA1 expression involve genes without a previously established association with FTLD. Biological functions and pathways enriched among deregulated genes were observed exclusively in LAMP5/PMEPA1 neurons. These include enrichment of upregulated genes in axon and learning or memory, and for the downregulated genes synaptic vessicles, membrane and axon.

### Non-neuronal

Among non-neuronal cell types—astrocytes (GFAP+ and GFAP-), microglia, and oligodendrocytes—a common reduction in HBB expression was observed in GFAP- (adjusted p= 0,043; FC: 0,23) and oligodendrocytes (adjusted p= 0,017; FC:, 0,22) (PMCID: PMC5786544). Functional enrichment analysis of deregulated genes in these cell types highlighted processes such as humoral immune response, axon guidance , memory, glial cell development and intrinsic apoptotic signaling pathway. Conversely, reductions were found in trans-synaptic signaling, social behavior and dendrites.

### Vascular

Arterial, capillary, smooth muscle cells (SMCs), and T cells were grouped as vascular cells. Differential expression analysis showed reduced expression of HBB in SMC (adjusted p= 0,035; FC: 0,23), HBA1 in arterial (adjusted p= 0,032; FC: 0,23), capillary (adjusted p= 0,032; FC: 0,22) and SMCs (adjusted p= 0,013; FC: 0,21) and HBA2 in arterial (adjusted p= 0,042; FC: 0,23), capillary (adjusted p= 0,017; FC: 0,23 ) and SMCs (adjusted p= 1.26e-81; FC: 0.22 ) in FTLD. An additional notable finding points to an upregulation tendency of CXCL11 in SMC (adjusted p= 0,069; FC: 19,66).

Pathway analysis revealed increased activity in processes such as behaviour , regulation of neuron apoptotic process, neuropeptide signaling pathway. Reductions were observed in regulation of biological processes, synaptic vessicle exocytocis, secretion , presynaptic membrane, oxygen carier activity, postsynapse. Genes of interest DE Nominal p-values

Analysis of nominal p-values per gene and cell type in FTLD-C9 revealed a number of genes exhibiting p \< 0.05 in specific cell populations, suggesting restricted transcriptional alterations. TUBA4A showed nominal significance in arterial cells (p = 0.011), capillaries (p = 0.006), CUX2/RASGRF2 neurons (p = 0.007), GFAP - astrocytes (p = 0.008), SST/NPY neurons (p = 0.003), T cells (p = 0.005), and THEMIS/TMEM233 cells (p = 0.006), indicating potential alterations in vascular, glial, and neuronal subtypes. FUS displayed significant nominal p-values in arterial cells (p = 0.002), capillaries (p = 0.005), CUX2/RASGRF2 neurons (p = 0.022), GFAP - astrocytes (p = 0.008), LAMP5/PMEPA1 neurons (p = 0.007), SST/NPY neurons (p = 0.018), T cells (p = 0.008), and THEMIS/TMEM233 cells (p = 0.009), suggesting widespread but cell type-specific transcriptional changes. C9orf72 exhibited striking nominal significance in arterial cells (p = 0.004), capillaries (p = 0.0003), CUX2/RASGRF2 neurons (p = 0.00004), GFAP - astrocytes (p = 0.0005), LAMP5/PMEPA1 neurons (p = 0.003), microglia (p = 0.002), oligodendrocytes (p = 0.008), SST/NPY neurons (p = 0.0002), T cells (p = 0.0005), and THEMIS/TMEM233 cells (p = 0.0004), confirming strong cell type-specific transcriptional effects. VCP showed significant p-values in arterial cells (p = 0.0002), capillaries (p = 0.00004), CUX2/RASGRF2 neurons (p = 0.0004), GFAP- astrocytes (p = 0.0002), microglia (p = 0.015), oligodendrocytes (p = 0.027), SST/NPY neurons (p = 0.0001), T cells (p = 0.00005), and THEMIS/TMEM233 cells (p = 0.0001), reflecting selective transcriptional dysregulation across multiple cell types. MATR3 presented nominal significance in arterial cells (p = 0.086), capillaries (p = 0.046), CUX2/RASGRF2 neurons (p = 0.042), GFAP - astrocytes (p = 0.047), LAMP5/PMEPA1 neurons (p = 0.061), microglia (p = 0.077), oligodendrocytes (p = 0.027), SST/NPY neurons (p = 0.032), and T cells (p = 0.032), suggesting moderate cell type-specific effects. DPP6 exhibited nominal significance in CDH4/SCGN neurons (p = 0.036), CUX2/RASGRF2 neurons (p = 0.003), GFAP + astrocytes (p = 0.003), microglia (p = 0.030), SST/NPY neurons (p = 0.005), and T cells (p = 0.024), indicating restricted but consistent alterations in excitatory neurons, astrocytes, and interneurons. Other genes such as NEFL, OPTN, GRN, TARDBP, HNRNPA1, MAPT, UNC13A, L3MBTL1, and VIPR1 displayed variable nominal significance across a few cell types, whereas many genes including NPTX2, UBQLN2, C19orf52, and ANO9 did not show any nominally significant changes in any cell type.

## Sant Pau

```{r}
#| echo: false
#| message: false
#| warning: false

library(readxl)
library(DT)

# Load Excel

file <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/RESULTS_ORDERED/5. CELL TYPE DEA/ALL_FTLD_C9.xlsx"
sheets <- excel_sheets(file)

tables <- lapply(sheets, function(s) read_excel(file, sheet = s))
names(tables) <- sheets
```

::: panel-tabset
```{r}
for (s in names(tables)) {
  cat("### ", s, "\n\n")  # Tab title
  
  print(
    datatable(
      tables[[s]],
      filter = "top",
      options = list(scrollX = TRUE, pageLength = 20)
    )
  )
  
  cat("\n\n")
}

```
:::

```{r}
#| eval: false
#| include: false
library(readxl)
library(plotly)
library(tidyverse)

# ---- File and sheets ----
file <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/RESULTS_ORDERED/5. CELL TYPE DEA/ALL_FTLD_C9.xlsx"
sheets <- excel_sheets(file)

# ---- Genes to highlight ----
genes_highlight <- c("")

# ---- Read and standardize data per sheet ----
data_list <- list()

for (sheet in sheets) {
  df_raw <- read_excel(file, sheet = sheet)
  
  # Standardize column names to lower + syntactically valid
  colnames(df_raw) <- tolower(make.names(colnames(df_raw), unique = TRUE))
  cols <- colnames(df_raw)
  
  # Try to find the relevant columns
  logfc_col <- intersect(c("logfc", "log2fc"), cols)
  fdr_col   <- intersect(c("adj_pval", "adj.pval", "fdr", "padj"), cols)
  pval_col  <- intersect(c("pvalue", "p.val", "pvalue", "pval"), cols)
  
  if (length(logfc_col) == 0 || length(fdr_col) == 0) {
    message("⚠️ Skipping ", sheet, " — missing logFC or FDR/adj_pval column.")
    next
  }
  
  data <- tibble(
    gene   = df_raw[[1]],  # assume first column is gene name (as in your example)
    logfc  = as.numeric(df_raw[[logfc_col[1]]]),
    fdr    = as.numeric(df_raw[[fdr_col[1]]]),
    pvalue = if (length(pval_col) > 0) as.numeric(df_raw[[pval_col[1]]]) else NA_real_
  ) %>%
    mutate(
      neglog10fdr = -log10(fdr),
      significance = case_when(
        fdr < 0.05 & logfc > 0 ~ "Upregulated",
        fdr < 0.05 & logfc < 0 ~ "Downregulated",
        TRUE ~ "Not significant"
      ),
      label = ifelse(gene %in% genes_highlight, gene, NA_character_)
    ) %>%
    drop_na(logfc, fdr)
  
  if (nrow(data) == 0) {
    message("⚠️ Skipping ", sheet, " — no valid rows after cleaning.")
    next
  }
  
  data_list[[sheet]] <- data
}

valid_sheets <- names(data_list)
message("✅ Prepared volcano data for: ", paste(valid_sheets, collapse = ", "))

# ---- Build a multi-sheet volcano plot with dropdown ----

# Colors as in your ggplot example
col_map <- c(
  "Upregulated"   = "#D55E00",
  "Downregulated" = "#0072B2",
  "Not significant" = "grey70"
)

fig <- plot_ly()
trace_ranges <- list()  # to remember which traces belong to each sheet

for (i in seq_along(valid_sheets)) {
  sheet <- valid_sheets[i]
  df <- data_list[[sheet]]
  
  start_idx <- length(fig$x$data) + 1
  
  # We mimic the ggplot: one layer, but in plotly we'll split by significance
  for (sig in c("Upregulated", "Downregulated", "Not significant")) {
    sub <- df %>% filter(significance == sig)
    if (nrow(sub) == 0) next
    
    # label only highlighted genes; others are ""
    text_labels <- ifelse(is.na(sub$label), "", sub$label)
    
    fig <- fig %>%
      add_trace(
        type = "scatter",
        mode = "markers+text",
        x = sub$logfc,
        y = sub$neglog10fdr,
        marker = list(
          color = col_map[sig],
          size = 6,
          opacity = 0.8
        ),
        text = text_labels,
        textposition = "top center",
        textfont = list(size = 9),
        hovertext = paste0(
          "<b>", sub$gene, "</b><br>",
          "logFC: ", round(sub$logfc, 2), "<br>",
          "FDR: ", signif(sub$fdr, 3)
        ),
        hoverinfo = "text",
        name = paste(sig, "-", sheet),
        showlegend = (i == 1),      # show legend only for first sheet
        visible = (i == 1)          # only first sheet visible initially
      )
  }
  
  end_idx <- length(fig$x$data)
  trace_ranges[[i]] <- start_idx:end_idx
}

# ---- Dropdown buttons ----
buttons <- lapply(seq_along(valid_sheets), function(i) {
  vis <- rep(FALSE, length(fig$x$data))
  vis[trace_ranges[[i]]] <- TRUE
  
  list(
    method = "update",
    args = list(
      list(visible = vis),
      list(title = paste("Interactive Volcano Plot —", valid_sheets[i]))
    ),
    label = valid_sheets[i]
  )
})

# ---- Layout ----
fig <- fig %>%
  layout(
    title = list(text = paste("Interactive Volcano Plot —", valid_sheets[1]), x = 0.05),
    xaxis = list(title = "log₂ Fold Change"),
    yaxis = list(title = "−log₁₀(FDR)"),
    updatemenus = list(list(
      y = 1.1,
      x = 0,
      buttons = buttons,
      direction = "down",
      showactive = TRUE,
      xanchor = "left",
      yanchor = "top",
      title = list(text = "Select cell state / sheet")
    ))
  )

fig
```

### Arterial
::: {.callout-note title="Show table" collapse="true"}
```{r}
counter <- 1
file <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/RESULTS_ORDERED/5. CELL TYPE DEA/ALL_FTLD_C9.xlsx"
sheets <- excel_sheets(file)

df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Capillary
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CDH4_CCK
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CDH4_SCGN
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CLMP_KCNMA1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CLMP_PDGFRA
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CUX2_RASGRF2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CUX2_RORB
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### DISC1_CCK
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### DISC1_RELN
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### GFAP_neg
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### GFAP_pos
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### LAMP5_CA3
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### LAMP5_PMEPA1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Micro
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Oligo
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### OPC
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PCP4_NXPH2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Pericyte
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PVALB_CEMIP
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PVALB_MYBPC1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PVALB_PTHLH
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_ADGRL4
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_FOXO1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_LRRK1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_POU3F2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SCN4B_NEFH
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SMC
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_ADAMTS19
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_BRINP3
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_GALNT14
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_NPY
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### T_Cell
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### THEMIS_NR4A2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### THEMIS_TMEM233
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### TLE4_CCBE1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### TLE4_MEGF11
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### TLE4_SEMA3D
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VAT1L_EYA4
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Venous
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VIP_CLSTN2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VIP_HTR2C
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VIP_LAMA3
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::

## Rimmod

```{r}
#| eval: false
#| include: false
library(readxl)
library(plotly)
library(tidyverse)

# ---- File and sheets ----
file <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/RESULTS_ORDERED/5. CELL TYPE DEA/ALL_Rimmod.xlsx"
sheets <- excel_sheets(file)

# ---- Genes to highlight ----
genes_highlight <- c("")

# ---- Read and standardize data per sheet ----
data_list <- list()

for (sheet in sheets) {
  df_raw <- read_excel(file, sheet = sheet)
  colnames(df_raw) <- tolower(make.names(colnames(df_raw), unique = TRUE))
  cols <- colnames(df_raw)

  logfc_col <- intersect(c("logfc", "log2fc"), cols)
  fdr_col   <- intersect(c("adj_pval", "adj.pval", "fdr", "padj"), cols)
  pval_col  <- intersect(c("pvalue", "p.val", "pval"), cols)

  if (length(logfc_col) == 0 || length(fdr_col) == 0) {
    message("⚠️ Skipping ", sheet, " — missing logFC or FDR/adj_pval column.")
    next
  }

  data <- tibble(
    gene   = df_raw[[1]],
    logfc  = as.numeric(df_raw[[logfc_col[1]]]),
    fdr    = as.numeric(df_raw[[fdr_col[1]]]),
    pvalue = if (length(pval_col) > 0) as.numeric(df_raw[[pval_col[1]]]) else NA_real_
  ) %>%
    mutate(
      neglog10fdr = -log10(fdr),
      significance = case_when(
        fdr < 0.05 & logfc > 0 ~ "Upregulated",
        fdr < 0.05 & logfc < 0 ~ "Downregulated",
        TRUE ~ "Not significant"
      ),
      label = ifelse(gene %in% genes_highlight, gene, NA_character_)
    ) %>%
    drop_na(logfc, fdr)

  if (nrow(data) == 0) {
    message("⚠️ Skipping ", sheet, " — no valid rows after cleaning.")
    next
  }

  data_list[[sheet]] <- data
}

valid_sheets <- names(data_list)
message("✅ Prepared volcano data for: ", paste(valid_sheets, collapse = ", "))

# ---- Fixed color palette (green for not significant) ----
col_map <- c(
  "Upregulated"   = "#D55E00",
  "Downregulated" = "#0072B2",
  "Not significant" = "#009E73"   # green tone (replace with grey70 if preferred)
)

# ---- Build multi-sheet plot ----
fig <- plot_ly()
trace_ranges <- list()

for (i in seq_along(valid_sheets)) {
  sheet <- valid_sheets[i]
  df <- data_list[[sheet]]

  start_idx <- length(fig$x$data) + 1

  for (sig in c("Upregulated", "Downregulated", "Not significant")) {
    sub <- df %>% filter(significance == sig)
    if (nrow(sub) == 0) next

    # Only label highlighted genes
    text_labels <- ifelse(is.na(sub$label), "", sub$label)

    fig <- fig %>%
      add_trace(
        type = "scatter",
        mode = "markers+text",
        x = sub$logfc,
        y = sub$neglog10fdr,
        marker = list(
          color = col_map[[sig]],
          size = 6,
          opacity = 0.8
        ),
        text = text_labels,
        textposition = "top center",
        textfont = list(size = 9),
        hovertext = paste0(
          "<b>", sub$gene, "</b><br>",
          "logFC: ", round(sub$logfc, 2), "<br>",
          "FDR: ", signif(sub$fdr, 3)
        ),
        hoverinfo = "text",
        name = sig,
        showlegend = (i == 1),
        visible = (i == 1)
      )
  }

  end_idx <- length(fig$x$data)
  trace_ranges[[i]] <- start_idx:end_idx
}

# ---- Dropdown ----
buttons <- lapply(seq_along(valid_sheets), function(i) {
  vis <- rep(FALSE, length(fig$x$data))
  vis[trace_ranges[[i]]] <- TRUE
  list(
    method = "update",
    args = list(
      list(visible = vis),
      list(title = paste("Interactive Volcano Plot —", valid_sheets[i]))
    ),
    label = valid_sheets[i]
  )
})

# ---- Layout ----
fig <- fig %>%
  layout(
    title = list(text = paste("Interactive Volcano Plot —", valid_sheets[1]), x = 0.05),
    xaxis = list(title = "log₂ Fold Change"),
    yaxis = list(title = "−log₁₀(FDR)"),
    updatemenus = list(list(
      y = 1.1,
      x = 0,
      buttons = buttons,
      direction = "down",
      showactive = TRUE,
      xanchor = "left",
      yanchor = "top",
      title = list(text = "Select cell state / sheet")
    ))
  )

fig

```

### Arterial
::: {.callout-note title="Show table" collapse="true"}
```{r}
counter <- 1
file <- "/media/jaumatell/datos/URI/BAYESPRISM_12_3/RESULTS_ORDERED/5. CELL TYPE DEA/ALL_Rimmod.xlsx"
sheets <- excel_sheets(file)

df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Capillary
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CDH4_CCK
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CDH4_SCGN
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CLMP_KCNMA1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CLMP_PDGFRA
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CUX2_RASGRF2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### CUX2_RORB
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### DISC1_CCK
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### DISC1_RELN
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### GFAP_neg
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### GFAP_pos
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### LAMP5_CA3
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### LAMP5_PMEPA1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Micro
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Oligo
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### OPC
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PCP4_NXPH2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Pericyte
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PVALB_CEMIP
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PVALB_MYBPC1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### PVALB_PTHLH
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_ADGRL4
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_FOXO1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_LRRK1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### RORB_POU3F2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SCN4B_NEFH
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SMC
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_ADAMTS19
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_BRINP3
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_GALNT14
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### SST_NPY
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### T_Cell
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### THEMIS_NR4A2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### THEMIS_TMEM233
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### TLE4_CCBE1
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### TLE4_MEGF11
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### TLE4_SEMA3D
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VAT1L_EYA4
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### Venous
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VIP_CLSTN2
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VIP_HTR2C
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::
### VIP_LAMA3
::: {.callout-note title="Show table" collapse="true"}
```{r}
df <- read_excel(file, sheet = sheets[counter])

# Show filterable interactive table
datatable(
  df,
  filter = "top",      # adds filter boxes on top
  options = list(
    pageLength = 25,   # default number of rows per page
    autoWidth = TRUE,
    scrollX = TRUE     # horizontal scroll if wide
  )
)

counter <- counter+1
```
:::